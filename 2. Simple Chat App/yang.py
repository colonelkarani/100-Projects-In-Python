import socket
import threading
import sys

print('''\033[91m
                                                                     .    ..........................
                                                                       .   ..  . ...................
                                                                              .....  ...............
                                             ... .                             .   .. ..............
                                 .     . ....:::.....           .             .    ... .............
                           .      .::-**---=*+==+:.::-::.... . ..                    . .............
                          ..::.....=%%%%@@@@%@@%###*+**==+--:..........:...     . . ....  ..........
                       .-.::+-::-=*%@@@@@@@@@@@@@@@@@@%%*=--=+--=---=-:.::.....   ..  .  ... .......
                      . -::=+%#**#@@@@@@@@@@@@@@#+-..     ...   .---*+=++-:-:..:...  . ... .........
                   -..:+%--*@@%@@@@@@@@@@@@%+-.                ..:..-++=*+=-::.:::......... ........
                  ...=*#*%#@@@@@@@@@@@@@@+-.                      .. -*#+=*==+=--::...... .... .....
                   .:-+%@@@@@@@@@@@@@@%+. .                  =-.   .  .:*==++#++==--::::............
             -:   .-#%@@@@@@@@@@@@@@@%=:           ..::..      . ...    .--++#@%###=--:::.... ......
             .*. :=@@@@@@@@@@@@@@@@@%+     .:  .=.:-:.- .:    .     . -#- .+===*%#+*+=-:::.. .. ... 
              .::@@@@@@@@@@@@@@@@@@#:     -.  -::-+++**+::     .. .   :::-==+*%=+@@%%#=-::..........
           ..:-+@@@@@@@@@@@@@@@@@@#=     .   .:=*@@@@@@@@=:            ..:=-:-+##@@@%++=-::.........
        ..  .-+%@@@@@@@@@%@@@@@@@@#-       ....-@@@@@@@@@*=.        :-.  . ::==++%#@@@#*+--:........
         .*#*+*@@@@@@@@@%@@@@@@@@@%-      :  .:=@@@@@@@@@@+:     .   ...  . :-+*=:+*@@%%#+=::...... 
        -+*@**%@@@@@@@@%@@@@@@@@@@*=      :    -#@@@@@@@@#::  .  .      .   -=-==*@%#%@@#++-::... . 
        =-:@@@@@@@@@@@@@@@@@@@@@@@#=       =  . .+#@@@@@=.:.    :..      .:  :::=-@@%%@@@**=-:::....
        .=-*@@@@@@@@@@@@@@@@%@@@@@%+.      .    .   :..  .... :-:..        :  *==++@+%@@@@#++-=:....
   .  ..+++%@@%@@@@@@@@@@@@@%@@@@@@#=.                   :.  :. .:.      :-.:  ++=#*@%*@@@%#=--:....
      .-*+#@@@@@@@@%%@@@@@@@%@@@@@@@#-:                   ..  ..   .:..... :.: .==%#%@*%@@%*++=:....
      .=%%#@@#@@@@@%@@@%@@@@@@@@@@@@@#+..           .           :--....    :.:+-.:#%%@%%@@@#*+=:....
      .*+@@@@#@@@@@%@@@%@@@@@@@@@@@@@@@#+-.  .                       .:  .  .:+*---#%#@@@@@#++-:....
      -*@@@@@@@@@@@#%@@%%@@@@@@%@@@@@@@@@*-:.:.    .:....             ..    ..=+-::+%*@@@@@@*----...
     .::+@@@@@@@@@@@*@@@*%@@@@@@@@@@@@@@@@@@%=::.            :==::.          =:-++-=%-@@@@@%**--:.. 
     ..-=%@@@@@@@@@@@@@@@@@@@@@@@@%@@@@@@@@@@@@@%#-=+=-.         ::...-.     .*--#*+*=@@@@@#+=-::...
      .-=#@@@@@@@@@@@@@@%@@@%@@@@@@@@%@@@@@@@@@@@@@@@@@*+*-::      ... --:. :.:+:#%#+#@@@@@%+-=::.. 
     ..-=#@@@@@@@@@@@@@@#%%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@=          . .:= =. *==@%%*+%@@@%+=--....
      .:-#@@@@@@@@@@@@@@@*#@@@%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@+. .       -== ...=+:@%@*:#@@@%#+=:..  
      .:@@@@@@@@@@@@@@@@@*+@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%+.       :=-   -++=*#%-:@@@@@%=-:.:..
       =@@%@@@@@@@@@@@@@@%*#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@+-    . .:=.  ++++-%==%@@@@#*=--:.. 
     ..:#*+#@@@@@@@@@@@@@@@##@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@-    -   =- .*+%*-=-%@@@@#++=-.... 
        .:*%@@@@@@@%@@@@@@@@#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@*: .  -  -- =+=%:==%@@@@%*+=-:.....
        ..-*%@@@@@@##@@@@@@@@%@@@@@@@@@@@@@@@@@%##%@@@@@@@@@@@@@@@-    .:.:.-**@%-%%@@@@@%++=-:.....
        ...=*%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%:     .=@@@@@@@@@@@@@#.  .:. ..#%@=:+@@@@@@@*++=-:--...
          .-=*@@@@@@@@@@@@@@%@@@@@@@@@@@@@@@=        -%@@@@@@@@@@@#:  :-:  +#%#:=@@@@@@%*+=--...... 
          .:==*@@@@@@@@@@@@@@@@@@@@@@@@@@@@%-        :@@@@@@@@@@@@#-  =-: .=@*:%@@@@@@%*+---:::.....
         :.--=+*%@@@@@@@@@@@@@@@@@@@@@@@@@@@*.      :*@@@@@@@@@@@@+ ..:+. *@++@@@@@@@%#+=+--:.......
        ....:+@@#@@@@@@@@@@@@@@@@@@%@@@@@@@@@%+=---#@@@@@@@@@@@@@*.: :++.+#%@@#@@@@%#*=-:---........
          --:*+-*@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%-: .#=.%%@%+@@@@@@##=:-::..... ....
             ..::+**@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@#-. -+.-%@##@@@@@@@#*+-::............
               ...-*#%#%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%+:::  =%@@@@@@@@@*##+=--:....:. .....
                  ..:%++*@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@*-.::  +@@@@@@@@@%#*+=--..::. ..  ......
                   ..:-+*%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%+--:::+@@@@@@@@@@@#*=---::....:...........
                   .. .-=--*%@@@@@@@@@@@@@@@@@@@@@@@@@@*++=*%@@@@@@@@@@@@%++==-:::..................
                   .....::.:==*%##*#@@@@@@@@@@@@@@@@@@@%@@@@@@@@@@@@@%*#+++-:::..:... ..............
                       .:....:---===+**%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@%+===+=-:......................
                        :.   ...:---..:=+++#%#%@###+=**+**@@*%@@%#%#+=--:--::.......................
                             ... :....:...:=====---::==:--**+*++==+++-:-::..........  .........:....
                                 :         .::....:::::..:..:.::---==::::.... ..... ........:.....:.
                                    .  .. . .. .  .......:.......:::.....  . . .................::::
                                                         ......-.....       .  .............::::::::
                                                            ..  ....   ..    ...............::::::::
\033[0m
''')

print('\n\nYou are Yang')
# ANSI color codes for terminal text colors
COLOR_YOUR = "\033[94m"  # Blue
COLOR_OTHER = "\033[92m"  # Green
COLOR_RESET = "\033[0m"

SERVER_HOST = '192.168.0.103'  # Replace with your server IP
SERVER_PORT = 9090

def receive_messages(sock):
    while True:
        try:
            message = sock.recv(1024).decode('utf-8')
            if not message:
                print("\nConnection closed by Yin.")
                break
            if message.lower() == 'quit':
                print("\nYin has ended the chat.")
                break
            # Print the incoming message
            print(f"\n{COLOR_OTHER}Yin says: {message}{COLOR_RESET}")
            print("> ", end='', flush=True)  # Reprompt user input line after incoming message
        except ConnectionResetError:
            print("\nConnection lost from Yin.")
            break
        except Exception as e:
            print(f"\nError receiving message: {e}")
            break
    sock.close()
    print("Connection closed. Yang exiting.")
    sys.exit(0)

def send_messages(sock):
    while True:
        try:
            message = input("> ")
            if message.lower() == 'quit':
                sock.sendall(message.encode('utf-8'))
                print("Quitting chat...")
                break
            sock.sendall(message.encode('utf-8'))
            print(f"{COLOR_YOUR}Yang: {message}{COLOR_RESET}")
        except BrokenPipeError:
            print("Connection lost. Unable to send message.")
            break
        except Exception as e:
            print(f"Error sending message: {e}")
            break
    sock.close()
    sys.exit(0)

def main():
    client_socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    try:
        client_socket.connect((SERVER_HOST, SERVER_PORT))
        print(f"Connected to Yin at {SERVER_HOST}:{SERVER_PORT} - Type 'quit' to exit.")
    except Exception as e:
        print(f"Failed to connect to Yin: {e}")
        return

    # Start a thread for receiving messages from the server
    recv_thread = threading.Thread(target=receive_messages, args=(client_socket,), daemon=True)
    recv_thread.start()

    # Main thread sends messages
    send_messages(client_socket)

if __name__ == "__main__":
    main()
